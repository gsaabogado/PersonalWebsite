---
import { getLangFromUrl, t } from "../../i18n/utils";
import SectionHeader from "../SectionHeader.astro";
import { getRecentPublications } from "../../data/publications";

const lang = getLangFromUrl(Astro.url);
const recentPubs = getRecentPublications(4);
---

<section class="py-24 px-4 bg-white">
  <div class="max-w-7xl mx-auto">
    <SectionHeader
      label={t(lang, "recent.label")}
      title={t(lang, "recent.title")}
    />

    <div class="mt-16 space-y-6">
      {recentPubs.map((pub, i) => (
        <div
          data-animate
          data-delay={`${0.1 + i * 0.1}s`}
          class="group bg-warm-gray rounded-xl p-6 hover:shadow-md transition-all duration-300 border border-cool-gray/50"
        >
          <div class="flex flex-col sm:flex-row sm:items-start gap-4">
            <span class="shrink-0 text-sm font-medium text-sky bg-sky/10 px-3 py-1 rounded-full">
              {pub.year}
            </span>
            <div class="flex-1 min-w-0">
              <h3 class="text-lg font-heading font-semibold text-slate-dark mb-1 leading-snug">
                {pub.url ? (
                  <a href={pub.url} target="_blank" rel="noopener noreferrer" class="hover:text-sky transition-colors">
                    {pub.title}
                  </a>
                ) : (
                  pub.title
                )}
              </h3>
              <p class="text-sm text-charcoal/50 mb-1">{pub.authors}</p>
              <p class="text-sm text-charcoal/70 italic">{pub.journal}</p>
            </div>
            {pub.url && (
              <a
                href={pub.url}
                target="_blank"
                rel="noopener noreferrer"
                class="shrink-0 text-sky hover:text-sky-light transition-colors"
                aria-label="Open paper"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                </svg>
              </a>
            )}
          </div>
        </div>
      ))}
    </div>
  </div>
</section>
